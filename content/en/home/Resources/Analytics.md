---
title: Analytics 2.0
weight: 209
description: "Here, you will find more about Analytics' functionalities."
---

---
## **Introduction**

Analytics is a powerful yet simple to use functionality that Beagle offers, it gives developers control over the tracking of actions and navigation of their application to use in conjunction with any analytics service they might be using.

In the next topics you will learn how to enable event tracking and configure it according to what you need. 

<a name="analytics-provider-anchor"></a>
## **Analytics provider**

The first thing we need to enable the Analytics functionality is to create a provider implementing the interface below

**AnalyticsProvider**
<a name="analytics-createRecord-anchor"></a>
| **Property**           | Definition                                                                                                         | Type                 |
| :--------------------- | :------------------------------------------------------------- | :----------------------------------------------------------------------- |
| **getConfig**          | Method that returns an [**AnalyticsConfig**]({{<ref "#analytics-config-anchor">}})                 | ``Method``           |
| **startSession**       | Starts a session for the analytics. This function can be used to initialize your analytics services when necessary | ``Method``           |
| **createRecord**       | This function will be called every time Beagle needs to create a record. If you don't want to send one request for each analytics generated by Beagle, it is a good idea to implement a batch mechanism within this function.                                                                              | ``Method``           |

{{% alert color="warning" %}}
 The createRecord method is the one responsible for handling the events of analytics tracking that are triggered throughout the application, It offers a single parameter of type [``AnalyticsRecord``]({{<ref "#analytics-record-anchor">}}), which then can be used according to your needs, e.g: send it to your tracking service like Google Analytics
{{% /alert %}}

Now, choose the platform you are using Beagle with to see examples of how to configure the Analytics Provider in your application

{{< tabs >}}
{{% tab name="Web" %}}

Open your Beagle service configuration file and create a function implementing the AnalyticsProvider interface like the following:

```text
...
import { AnalyticsProvider, AnalyticsConfig, AnalyticsRecord } from '@zup-it/beagle-web'

function analytics(): AnalyticsProvider {

  function getConfig() {
    return new Promise<AnalyticsConfig>((resolve, reject) => {
      resolve({
        enableScreenAnalytics: true,
        actions: {'beagle:pushView': ['route.screen'], 'beagle:alert': ['']}
      })
    })
  }

  function createRecord(record: AnalyticsRecord){
    console.log('Record', record)
  }

  function startSession(){
    return new Promise<void>((resolve, reject) => {
      resolve('success')
    })
  }

  return {
    getConfig,
    createRecord,
    startSession
  }
}

export default createBeagleUIService<any>({
  ...
  analyticsProvider: analytics()
})

```
{{% alert color="warning" %}}
 Note: Usually the "getConfig" and "startSession" functions would make an HTTP request for their respective services, but for the sake of this example we created a local promise returning the expected structure for each
{{% /alert %}}

{{% /tab %}}

{{% tab name="Android" %}}
<!-- To do analytics android -->
{{% /tab %}}
{{% tab name="iOS" %}}
<!-- To do analytics iOS -->
{{% /tab %}}
{{< /tabs >}}

## **How does it work ?**

As soon as you finish configuring the Analytics provider you are ready to start defining the events you want to track in your Beagle application, there are two ways to do so which are the ``ActionAnalyticsConfig`` and the ``AnalyticsConfig``.

You can either use both configuration payloads or choose the one that better fits your solution, an important point to note here is that the ``ActionAnalyticsConfig`` has priority over the ``AnalyticsConfig`` which means that if you configure the same tracking event for both of them the ``ActionAnalyticsConfig`` will be used.

see next further details on both ways of mapping the analytics

### **Action configuration**

The easiest way to enable tracking with Beagle is through the BFF, you can simply enable which actions you want tracked by adding to them the key analytics.

First we choose which action we want to create the event and add the analytics property to them.

example:

{{< tabs >}}
{{% tab name="JSON" %}}
```text
{
  "_beagleComponent_": "beagle:button",
    "text": "Button with analytics",
    "onPress": [
      {
        "_beagleAction_": "beagle:pushStack",
        "analytics": false
      }
    ]
}
```
{{% /tab %}}
{{% tab name="BFF" %}}
<!-- To do analytics BFF -->
{{% /tab %}}
{{< /tabs >}}

The analytics property accepts two types of values it can be a boolean that when set to false disables all the tracking for that action or it can be an structure of type ``ActionAnalyticsConfig`` detailed next.

**ActionAnalyticsConfig**
| **Property**           | Definition                                                     | Type             |
| :--------------------- | :------------------------------------------------------------- | :--------------- |
| **attributes**         | List of attributes to be exposed to the analytics interface    | ``Array <string>``   |
| **additionalEntries**  | Any additional data you may want to send along with the action | ``Map<string, any>`` |

Using this interface you can control individually the actions and also the action's properties you want to be sent to the [``createRecord``]({{<ref "#analytics-createRecord-anchor">}}) 
method from the [``AnalyticsProvider``]({{<ref "#analytics-provider-anchor">}}). The next example shows how your payload should be handed to your application in order to enable the analytics functionality.

```text
    {
      "_beagleComponent_": "beagle:button",
      "text": "Button with analytics",
      "onPress": [
        {
          "_beagleAction_": "beagle:pushStack",
          "analytics": {
            "additionalEntries": {
              "extra": "Extra information"
            },
            "attributes": [
              "route"
            ]
          },
          "route": {
            "url": "/myRoute.json"
          }
        }
      ]
    }
```
This configuration allows a better control over each one of the actions directly from the screen payload. In the previous example we are passing inside the analytics key two properties, the ``additionalEntries`` that can be anything you might need and in our case we are passing a simple text, the ``attributes`` property has to be one of the properties of the action in our example we are passing the key route that will send the value of the route key to create the analytics record. 

Next you will learn how to configure the tracking from a configuration payload.

### **Analytics configuration payload**
<a name="analytics-config-anchor"></a>
Another way to use the Analytics functionality is with a configuration payload which contains the actions or navigation events to be tracked, this configuration will usually be requested and returned within the [``getConfig``]({{<ref "#analytics-createRecord-anchor">}}) method of the AnalyticsProvider interface.

The library offers an API interface to guide us through the configuration, see below.

**AnalyticsConfig**
| **Property**                  | Definition                          | Type |
| :-----------                  | :---------------------------------- | :-------- |
| **enableScreenAnalytics**     | Default is `true`, when false no analytics will be generated by this system when a screen is loaded| ``boolean`` |
| **actions**  | A map of actions allowed to create analytics records. By default no action creates records. In this map, each key is a _beagleAction_, while the values are the array of strings. The value indicates which properties of the given action will be tracked| Map<[**BeagleAction**](/home/api/actions/), Array<string>>|

See below an example of an expected payload format

```text
{
  enableScreenAnalytics: true,
  actions: {'beagle:pushView': ['route.screen'], 'beagle:alert': ['']}
}
```

Note in the previous example that we enabled the analytics for screen events, in this case every time a navigation action occurs the tracking method will be called to create a record for the current route with its data and identifier. The second attribute is a map structure of [**Beagle actions**](/home/api/actions/) and for each action an Array of strings, we can then control the actions we want to be tracked and what attributes of that action should be passed along to create its records.


<a name="analytics-record-anchor"></a>
### **Analytics Record**

After you have configured your analytics provider, every time an analytics event occurs within Beagle applications the [``createRecord``]({{<ref "#analytics-createRecord-anchor">}}) method is called and it gives access to a parameter of type analyticsRecord.

The analytics record interface defines what properties a Beagle event will contain:

**AnalyticsRecord**
| **Property**         | Definition                                                     | Type             |
| :--------------------| :------------------------------------------------------------- | :--------------- |
| **type**             | The type of the analytics record 'screen' for navigation events or 'action' for action triggered events  | ``string``          |
| **platform**         | The platform in which the event was triggered for example WEB    | ``string``   |
| **key**              | Any additional data sent along with the action, it may be different among the platforms but the main keys are the name of the event and details about the Beagle component like type, id and position | ``Array<any>`` |